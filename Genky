-- External executor script

-- References to folders and specific parts
local clovaFolder = game:GetService("Workspace"):WaitForChild("clova")
local buttonsFolder = game:GetService("Workspace"):WaitForChild("Buttons")
local rollRarityTouch = game:GetService("Workspace")["Roll System"]:WaitForChild("RollRarity")
local normalRuneRollRarity = game:GetService("Workspace").normal.runez:WaitForChild("RollRarity") -- Added part

local player = game.Players.LocalPlayer -- Reference to the player
local character = player.Character or player.CharacterAdded:Wait() -- Ensure character is loaded
local rootPart = character:WaitForChild("HumanoidRootPart") -- Get the player's root part

-- Function to process TouchTransmitter of a given part
local function processTouchTransmitter(part)
    local touchTransmitter = part:FindFirstChildOfClass("TouchTransmitter") -- Find TouchTransmitter
    if touchTransmitter then
        -- Fire the TouchTransmitter
        firetouchinterest(part, rootPart, 0)
        firetouchinterest(part, rootPart, 1)
    end
end

-- Function to monitor the clova folder
local function monitorClovaFolder()
    while true do
        for _, model in ipairs(clovaFolder:GetChildren()) do
            if model:IsA("Model") then -- Process all models
                local rootPart = model:FindFirstChild("Root") -- Check for the "Root" part
                if rootPart and rootPart:IsA("BasePart") then
                    processTouchTransmitter(rootPart)
                end
            end
        end
        wait() -- Independent loop delay
    end
end

-- Function to handle the RollRarity TouchInterest
local function monitorRollRarity()
    while true do
        if rollRarityTouch and rollRarityTouch:IsA("BasePart") then
            processTouchTransmitter(rollRarityTouch)
        end
        wait() -- Independent loop delay
    end
end

-- Function to handle the normal.runez.RollRarity TouchInterest
local function monitorNormalRuneRollRarity()
    while true do
        if normalRuneRollRarity and normalRuneRollRarity:IsA("BasePart") then
            processTouchTransmitter(normalRuneRollRarity)
        end
        wait() -- Independent loop delay
    end
end

-- Function to handle prioritized buttons in an independent loop
local function processPrioritizedButtons()
    while true do
        local prioritizedButtons = {}

        -- Gather prioritized buttons
        for _, button in ipairs(buttonsFolder:GetChildren()) do
            if button:IsA("BasePart") then
                -- Add buttons with "Rebirth" in their names
                if string.find(button.Name, "Rebirth") then
                    table.insert(prioritizedButtons, button)
                end

                -- Add specifically named buttons
                if button.Name == "200" or button.Name == "160" or 
                   button == buttonsFolder:GetChildren()[33] or 
                   button == buttonsFolder:GetChildren()[32] or 
                   button == buttonsFolder:GetChildren()[31] then
                    table.insert(prioritizedButtons, button)
                end
            end
        end

        -- Process prioritized buttons
        for _, button in ipairs(prioritizedButtons) do
            processTouchTransmitter(button) -- Fire the TouchTransmitter
            wait() -- Delay between firing each prioritized button
        end
    end
end

-- Function to cycle through non-prioritized buttons
local function cycleThroughButtons()
    while true do
        for _, button in ipairs(buttonsFolder:GetChildren()) do
            if button:IsA("BasePart") and 
               button.Name ~= "Super Multi Get" and button.Name ~= "Prestige Get" and
               not string.find(button.Name, "Rebirth") and 
               button.Name ~= "200" and button.Name ~= "160" and
               button ~= buttonsFolder:GetChildren()[33] and 
               button ~= buttonsFolder:GetChildren()[32] and 
               button ~= buttonsFolder:GetChildren()[31] then
                processTouchTransmitter(button) -- Fire the TouchTransmitter
                wait() -- Delay between firing each button
            end
        end
        wait() -- Delay before cycling through buttons again
    end
end

-- Start all functions in independent threads
task.spawn(monitorClovaFolder)
task.spawn(monitorRollRarity)
task.spawn(monitorNormalRuneRollRarity)
task.spawn(processPrioritizedButtons) -- Start independent loop for prioritized buttons
task.spawn(cycleThroughButtons) -- Start loop for non-prioritized buttons
